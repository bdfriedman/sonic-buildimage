From 66664488736a25adec92aaabb357d544ec4d1faf Mon Sep 17 00:00:00 2001
From: Mrinmoy Ghosh <mrinmoy_g@hotmail.com>
Date: Tue, 19 Aug 2025 23:41:53 +0000
Subject: [PATCH 4/9] zebra : EVPN VXLAN MH extern mode: Update debug print for
 NDA_PROTOCOL

This is to update netlink debug print,
 to print 'protocol' i.e NDA_PROTOCOL field for netlink messages.

Signed-off-by: Mrinmoy Ghosh <mrinmoy_g@hotmail.com>
Signed-off-by: Mrinmoy Ghosh <mrghosh@cisco.com>
Signed-off-by: Tamer Ahmed <tamerahmed@microsoft.com>
---
 zebra/debug_nl.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/zebra/debug_nl.c b/zebra/debug_nl.c
index d1d65f1e32..3b476073e0 100644
--- a/zebra/debug_nl.c
+++ b/zebra/debug_nl.c
@@ -571,6 +571,8 @@ const char *neigh_rta2str(int type)
 		return "MASTER";
 	case NDA_LINK_NETNSID:
 		return "LINK_NETNSID";
+	case NDA_PROTOCOL:
+		return "PROTOCOL";
 	default:
 		return "UNKNOWN";
 	}
@@ -1146,6 +1148,7 @@ static void nlneigh_dump(struct ndmsg *ndm, size_t msglen)
 	char bytestr[16];
 	char dbuf[128];
 	unsigned short rta_type;
+	uint8_t protocol = 0;
 
 #ifndef NDA_RTA
 #define NDA_RTA(ndm)                                                           \
@@ -1200,7 +1203,10 @@ next_rta:
 		vid = *(uint16_t *)RTA_DATA(rta);
 		zlog_debug("      %d", vid);
 		break;
-
+	case NDA_PROTOCOL:
+		protocol = *(uint8_t *)RTA_DATA(rta);
+		zlog_debug("      %d", protocol);
+		break;
 	default:
 		/* NOTHING: unhandled. */
 		break;
-- 
2.43.0

